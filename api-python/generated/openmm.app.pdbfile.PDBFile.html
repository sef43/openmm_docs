
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>PDBFile &#8212; OpenMM Python API c2d2539933259d85365b465b39e6c3113559e016 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PDBxFile" href="openmm.app.pdbxfile.PDBxFile.html" />
    <link rel="prev" title="GromacsTopFile" href="openmm.app.gromacstopfile.GromacsTopFile.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pdbfile">
<h1>PDBFile<a class="headerlink" href="#pdbfile" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">openmm.app.pdbfile.</span></span><span class="sig-name descname"><span class="pre">PDBFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraParticleIdentifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EP'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile" title="Permalink to this definition">¶</a></dt>
<dd><p>PDBFile parses a Protein Data Bank (PDB) file and constructs a Topology and a set of atom positions from it.</p>
<p>This class also provides methods for creating PDB files.  To write a file containing a single model, call
writeFile().  You also can create files that contain multiple models.  To do this, first call writeHeader(),
then writeModel() once for each model in the file, and finally writeFooter() to complete the file.</p>
<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraParticleIdentifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EP'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a PDB file.</p>
<p>The atom positions and Topology can be retrieved by calling getPositions() and getTopology().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em><em> or </em><em>file</em>) – the name of the file to load.  Alternatively you can pass an open file object.</p></li>
<li><p><strong>extraParticleIdentifier</strong> (<em>string='EP'</em>) – if this value appears in the element column for an ATOM record, the Atom’s element will be set to None to mark it as an extra particle</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#openmm.app.pdbfile.PDBFile.__init__" title="openmm.app.pdbfile.PDBFile.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(file[, extraParticleIdentifier])</p></td>
<td><p>Load a PDB file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openmm.app.pdbfile.PDBFile.getNumFrames" title="openmm.app.pdbfile.PDBFile.getNumFrames"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getNumFrames</span></code></a>()</p></td>
<td><p>Get the number of frames stored in the file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openmm.app.pdbfile.PDBFile.getPositions" title="openmm.app.pdbfile.PDBFile.getPositions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getPositions</span></code></a>([asNumpy, frame])</p></td>
<td><p>Get the atomic positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openmm.app.pdbfile.PDBFile.getTopology" title="openmm.app.pdbfile.PDBFile.getTopology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getTopology</span></code></a>()</p></td>
<td><p>Get the Topology of the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openmm.app.pdbfile.PDBFile.writeFile" title="openmm.app.pdbfile.PDBFile.writeFile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeFile</span></code></a>(topology, positions[, file, ...])</p></td>
<td><p>Write a PDB file containing a single model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openmm.app.pdbfile.PDBFile.writeFooter" title="openmm.app.pdbfile.PDBFile.writeFooter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeFooter</span></code></a>(topology[, file])</p></td>
<td><p>Write out the footer for a PDB file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openmm.app.pdbfile.PDBFile.writeHeader" title="openmm.app.pdbfile.PDBFile.writeHeader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeHeader</span></code></a>(topology[, file])</p></td>
<td><p>Write out the header for a PDB file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openmm.app.pdbfile.PDBFile.writeModel" title="openmm.app.pdbfile.PDBFile.writeModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeModel</span></code></a>(topology, positions[, file, ...])</p></td>
<td><p>Write out a model to a PDB file.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile.getTopology">
<span class="sig-name descname"><span class="pre">getTopology</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile.getTopology" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Topology of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile.getNumFrames">
<span class="sig-name descname"><span class="pre">getNumFrames</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile.getNumFrames" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of frames stored in the file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile.getPositions">
<span class="sig-name descname"><span class="pre">getPositions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asNumpy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile.getPositions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atomic positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asNumpy</strong> (<em>boolean=False</em>) – if true, the values are returned as a numpy array instead of a list
of Vec3s</p></li>
<li><p><strong>frame</strong> (<em>int=0</em>) – the index of the frame for which to get positions</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile.writeFile">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">writeFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepIds=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraParticleIdentifier='EP'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile.writeFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file containing a single model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topology</strong> (<a class="reference internal" href="openmm.app.topology.Topology.html#openmm.app.topology.Topology" title="openmm.app.topology.Topology"><em>Topology</em></a>) – The Topology defining the model to write</p></li>
<li><p><strong>positions</strong> (<em>list</em>) – The list of atomic positions to write</p></li>
<li><p><strong>file</strong> (<em>file=stdout</em>) – A file to write to</p></li>
<li><p><strong>keepIds</strong> (<em>bool=False</em>) – If True, keep the residue and chain IDs specified in the Topology
rather than generating new ones.  Warning: It is up to the caller to
make sure these are valid IDs that satisfy the requirements of the
PDB format.  Otherwise, the output file will be invalid.</p></li>
<li><p><strong>extraParticleIdentifier</strong> (<em>string='EP'</em>) – String to write in the element column of the ATOM records for atoms whose element is None (extra particles)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile.writeHeader">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">writeHeader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile.writeHeader" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out the header for a PDB file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topology</strong> (<a class="reference internal" href="openmm.app.topology.Topology.html#openmm.app.topology.Topology" title="openmm.app.topology.Topology"><em>Topology</em></a>) – The Topology defining the molecular system being written</p></li>
<li><p><strong>file</strong> (<em>file=stdout</em>) – A file to write the file to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile.writeModel">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">writeModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelIndex=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepIds=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraParticleIdentifier='EP'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile.writeModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out a model to a PDB file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topology</strong> (<a class="reference internal" href="openmm.app.topology.Topology.html#openmm.app.topology.Topology" title="openmm.app.topology.Topology"><em>Topology</em></a>) – The Topology defining the model to write</p></li>
<li><p><strong>positions</strong> (<em>list</em>) – The list of atomic positions to write</p></li>
<li><p><strong>file</strong> (<em>file=stdout</em>) – A file to write the model to</p></li>
<li><p><strong>modelIndex</strong> (<em>int=None</em>) – If not None, the model will be surrounded by MODEL/ENDMDL records
with this index</p></li>
<li><p><strong>keepIds</strong> (<em>bool=False</em>) – If True, keep the residue and chain IDs specified in the Topology
rather than generating new ones.  Warning: It is up to the caller to
make sure these are valid IDs that satisfy the requirements of the
PDB format.  No guarantees are made about what will happen if they
are not, and the output file could be invalid.</p></li>
<li><p><strong>extraParticleIdentifier</strong> (<em>string='EP'</em>) – String to write in the element column of the ATOM records for atoms whose element is None (extra particles)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.pdbfile.PDBFile.writeFooter">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">writeFooter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.pdbfile.PDBFile.writeFooter" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out the footer for a PDB file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topology</strong> (<a class="reference internal" href="openmm.app.topology.Topology.html#openmm.app.topology.Topology" title="openmm.app.topology.Topology"><em>Topology</em></a>) – The Topology defining the molecular system being written</p></li>
<li><p><strong>file</strong> (<em>file=stdout</em>) – A file to write the file to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="openmm.app.gromacstopfile.GromacsTopFile.html" title="Previous document">GromacsTopFile</a>
        </li>
        <li>
          <a href="openmm.app.pdbxfile.PDBxFile.html" title="Next document">PDBxFile</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">OpenMM Python API</h1>
    
  </a>
</p>










<script>
    function switchVersion(value) {
        newlink = value + "api-python"
        location.href = newlink;
    }
</script>

<div class="extra-nav-links">
These docs are for <a href="https://github.com/openmm/openmm/tree/c2d2539933259d85365b465b39e6c3113559e016">OpenMM version 8.0.0.dev-c2d2539</a>
</div>
<div class="extra-nav-links">
You can change to a different version:
<select name="version" id="version_selector" onchange="switchVersion(this.value)">
    <option selected disabled>8.0.0.dev-c2d2539</option>
</select>
</div>

<script>
var selector = document.getElementById("version_selector");
// TODO: move hardcoded url to conf.py
fetch("https://sef43.github.io/openmm_docs/versions.json")
    .then((res) => {
      return res.json();
    })
    .then((data) => {
      data.forEach((entry) => {
        version=entry.version
        url=entry.url
        var option = document.createElement("option");
        option.value = url
        option.text = version
        selector.appendChild(option);
      })
    })
</script>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="navigation-scrollbox">
    <div class="nav-toctree">
    <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../app.html">Application Layer</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../app.html#loaders-and-setup">Loaders and Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app.html#representation-and-manipulation">Representation and Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app.html#simulation">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app.html#reporting-output">Reporting Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app.html#extras">Extras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app.html#units">Units</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../library.html">Library Layer</a></li>
</ul>

    </div>
    
    <ul class="extra-nav-links">
        
        <li class="toctree-l1">
            <a href="https://openmm.org">
                OpenMM.org
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="../../userguide/">
                User's Manual
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="../../developerguide/">
                Developer Guide
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="../../api-c++/">
                C++ API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://github.com/openmm">
                GitHub
            </a>
        </li>
        
    </ul>
    
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Stanford University and the Authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/generated/openmm.app.pdbfile.PDBFile.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>